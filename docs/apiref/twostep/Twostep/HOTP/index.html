<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>HOTP (twostep.Twostep.HOTP)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">twostep</a> &#x00BB; <a href="../index.html">Twostep</a> &#x00BB; HOTP</nav><h1>Module <code>Twostep.HOTP</code></h1><p>Module for HOTP algorithm.</p></header><aside><p>This algorithm is useful on contexts of confirmation/authentication from other linked channels, for instance, email inbox messages or the discouraged SMS channel. In other words, where the server has full control of OTP token generation and sends it for the end-user through a trusted / linked third-party channel. <i>Important note:</i> you must generate a different secret for every linked third-party channel. Also, you should limit the window for user authentication once the token / code is sent on a third-party channel, something like 5 or 10 minutes to expire regarding the third-party channel's delay to receive messages.</p></aside><dl><dt class="spec value" id="val-secret"><a href="#val-secret" class="anchor"></a><code><span class="keyword">val</span> secret : <span>?&#8288;bytes:int</span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> string</code></dt><dd><p>Generates a valid Base-32 OTP secret (for both HOTP and TOTP algorithms, but don't mix them with the same secret, instead, generate a secret for every kind of usage). The optional <code>bytes</code> parameter represents the size of underlying binary/blob string of the encoded Base-32 secret. Such parameter must be at least <code>10</code> and <i>an integer divisible by 5</i>.</p></dd></dl><dl><dt class="spec value" id="val-codes"><a href="#val-codes" class="anchor"></a><code><span class="keyword">val</span> codes : <span>?&#8288;digits:int</span> <span>&#45;&gt;</span> <span>?&#8288;hash:string</span> <span>&#45;&gt;</span> <span>?&#8288;amount:int</span> <span>&#45;&gt;</span> <span>counter:int</span> <span>&#45;&gt;</span> <span>secret:string</span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <span>string list</span></code></dt><dd><p>Generates a sequence of HOTP tokens/codes with length <code>amount</code> (defaults to <code>1</code>), where every code string has the size of optional parameter <code>digits</code> (defaults to <code>6</code>). The optional parameter <code>secret</code> must be a valid Base-32 string and <code>counter</code> is possibly retrieved from some storage. The default <code>hash</code> algorithm is <code>&quot;SHA-1&quot;</code>, but the hashes <code>&quot;SHA-256&quot;</code> and <code>&quot;SHA-512&quot;</code> also work.</p></dd></dl><dl><dt class="spec value" id="val-verify"><a href="#val-verify" class="anchor"></a><code><span class="keyword">val</span> verify : <span>?&#8288;digits:int</span> <span>&#45;&gt;</span> <span>?&#8288;hash:string</span> <span>&#45;&gt;</span> <span>?&#8288;ahead:int</span> <span>&#45;&gt;</span> <span>counter:int</span> <span>&#45;&gt;</span> <span>secret:string</span> <span>&#45;&gt;</span> <span>codes:<span>string list</span></span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> bool * int</code></dt><dd><p>Operation to verify a sequence of codes with optional look-<code>ahead</code> parameter (defaults to <code>0</code>, a constraint for how much the server's counter can differ from client's counter, so it attempts to sync-in by incrementing the counter), <code>digits</code> of every HOTP string code (defaults to <code>6</code>) and underlying <code>hash</code> algorithm for internal HMAC (defaults to <code>&quot;SHA-1&quot;</code>, values <code>&quot;SHA-256&quot;</code> and <code>&quot;SHA-512&quot;</code> are also accepted). The <code>secret</code> parameter must be a valid Base-32 secret. The <code>counter</code> is a nonce persisted on storage for given end-user. A non-empty list of <code>codes</code> provided by the client/end-user is a sequence generated with counters applied in an incremental way for every code. Returns a pair of verification status (<code>true</code> or <code>false</code>) and a resynchronized next counter to replace the current counter on storage (only if verification is successful with <code>true</code>, otherwise the counter is not updated and returns the same counter of operation input).</p></dd></dl></div></body></html>